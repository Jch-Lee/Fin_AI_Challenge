# 2025-08-20 개발 로그

## 🏆 주요 성과: 리더보드 0.55 달성!

### 핵심 성과
- **이전 점수**: 0.46
- **현재 점수**: 0.55 (**+19.6% 향상**)
- **순위**: 대폭 상승
- **핵심 기술**: BM25+Vector Top3 독립 선택 방식

## 오늘의 실험

### 실험 1: BM25 vs Vector 독립 비교
- **목적**: 각 검색 방법의 독립적 성능 평가
- **결과**: 
  - 객관식 일치율 70%
  - 프롬프트 엔지니어링이 검색 방법보다 중요함 확인

### 실험 2: BM25+Vector 결합 방식 구현
- **접근법**: 각 방법에서 독립적으로 상위 3개씩 선택
- **장점**:
  - 각 검색 방법의 강점 보존
  - 가중치 통합보다 우수한 성능
  - 정보 다양성 극대화

### 실험 3: 전체 테스트셋 검증
- **처리**: 515문제 성공적 완료
- **시간**: 약 4분 15초
- **결과**: 리더보드 0.55 점수 달성

## 구현 완료

### CombinedTopRetriever 개발
```python
# packages/rag/retrieval/combined_top_retriever.py
class CombinedTopRetriever:
    def search(self, query: str, bm25_k=3, vector_k=3):
        # BM25에서 상위 3개 독립 선택
        bm25_results = self.search_bm25(query, k=bm25_k)
        # Vector에서 상위 3개 독립 선택
        vector_results = self.search_vector(query, k=vector_k)
        # 결합 (중복 허용)
        return bm25_results + vector_results
```

### 메인 파이프라인 통합
- RAGPipeline에 "combined_top" retriever 타입 추가
- 기본 retriever로 설정
- configs/rag_config.yaml v3.0 업데이트

## 기술적 인사이트

### 왜 독립 선택이 더 나은가?
1. **강점 보존**: 각 방법의 고유한 특성 유지
   - BM25: 정확한 키워드 매칭
   - Vector: 의미적 유사성

2. **가중치 문제 해결**:
   - 가중치 통합은 점수를 섞어서 희석
   - 독립 선택은 각각의 best를 그대로 활용

3. **정보 다양성**:
   - 중복 허용으로 중요 문서 강조
   - 다양한 관점의 정보 제공

## 코드 변경사항

### 신규 파일
- `packages/rag/retrieval/combined_top_retriever.py`
- `docs/experiment_logs/2025-08-20_RAG_검색방법_비교실험.md`
- `docs/CURRENT_STATUS_2025_08_20.md`

### 수정된 파일
- `packages/rag/rag_pipeline.py` - combined_top 지원 추가
- `packages/rag/retrieval/__init__.py` - CombinedTopRetriever export
- `configs/rag_config.yaml` - v3.0 업데이트
- `docs/README.md` - 최신 성과 반영
- `docs/architecture/4-components-current-implementation.md`
- `docs/project-plan/성공-지표.md` - MVP 달성 기록

## 디버깅 과정

### 문제 1: Import 오류
- RAGSystem → RAGPipeline 클래스명 변경

### 문제 2: BM25 메서드 오류
- `retrieve` 메서드 없음 → `get_top_n` 사용

### 문제 3: GPU 메모리 부족
- 임베더 반복 생성 → 한 번만 초기화하고 재사용

### 문제 4: 데이터 구조 불일치
- 청크가 딕셔너리 → 'content' 키 추출

## 성능 메트릭

### 처리 성능
- **속도**: 2-3 문제/초
- **메모리**: 안정적 (100개마다 GC)
- **전체 시간**: 4분 15초 (515문제)

### 리더보드 성능
- **점수**: 0.55
- **향상률**: +19.6%
- **MVP 목표**: 모두 달성

## 교훈

1. **실증적 검증의 중요성**: 이론보다 실제 점수가 중요
2. **독립성의 가치**: 각 방법의 강점을 희석시키지 말 것
3. **빠른 반복**: 신속한 실험과 검증이 핵심
4. **프롬프트 엔지니어링**: 극도의 제약이 일관성 향상

## 다음 단계

### 단기 (이번 주)
- [ ] 프롬프트 추가 최적화
- [ ] 문제 유형별 k값 동적 조정
- [ ] 청크 크기 실험

### 중기 (다음 주)
- [ ] 리랭킹 모델 재검토
- [ ] 앙상블 접근법 연구
- [ ] 학습 데이터 증강

## 참고사항

- 제출 파일: `submission_bm25_vector_top3_20250820_121132.csv`
- 실험 노트: `docs/experiment_logs/2025-08-20_RAG_검색방법_비교실험.md`
- 현재 상태: 프로덕션 준비 완료

---

**작성자**: AI 개발팀
**검토자**: 팀 리더
**상태**: ✅ 완료