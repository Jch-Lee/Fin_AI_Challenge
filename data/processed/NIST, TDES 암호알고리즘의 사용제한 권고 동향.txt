\n## Page 1\n\n- 주제목: NIST, TDES 암호알고리즘의 사용제한 권고 동향
- 중제목: (보안기술연구팀, 2018.8.8.)

### 본문
#### 1 개요
- 최근 NIST에서는 구조적 취약성을 이유로 특정 암호알고리즘의 용도에 따른 사용제한을 권고함
- 2018년 7월에 개정된 NIST표준문서(SP800-131A)의 주요 개정 사항은 TDES 암호알고리즘의 사용중지 계획이며,
* NIST에서는 TDEA(Triple Data Encryption Algorithm)로 표기하며, 국내에서는 TDES(Triple Data Encryption Standard) 또는 3DES로 표기함
- 동 표준은 2030년까지로 안전성을 허용했던 TDES의 사용을 점진적으로 중지하도록 권고하고 있음
- < NIST 소개 >
- NIST(미국 국립표준기술연구소): 미국 상무부 산하 기관으로서 컴퓨터 보안, 정보기술 분야와 관련된 미국 내의 표준 지정 및 가이드라인, 권장사항, 기술 사양 등의 간행물을 배포
- NIST 문서: 암호를 포함한 정보기술 등 관련 분야에서 국제적인 로드맵을 주도하는 역할을 하고 있음
* 우리나라 고시, 가이드라인 안내서에 명시된 '안전한 암호 알고리즘'은 국내·외 전문기관(KISA, NIST, ECRYPT, CRYPTREC 등)이 권고하는 암호알고리즘을 뜻함
- 본 보고서에서는 TDES 암호알고리즘 사용중지 이유와 이로 인한 금융권의 대응방안을 살펴보고자 함
#### 각주
1) SP800-131A: 안전한 암호알고리즘의 종류와 사용 권고 기간을 제시하고 있으며, 국내·외에서 알고리즘의 보안성을 확인 할 때 주로 참고\n\n## Page 2\n\n
### 텍스트 내용
#### (가) TDES의 소개
- (특징) TDES는 DES*를 세 번 연이어 연산하는 암호알고리즘으로 1998년 배포(ANSI X9.52 문서)되었고, DES와 동일한 블록 크기(64bit)를 가지는 블록암호임
* DES는 64bit의 평문을 56bit의 키로 암호화 하는 구조적 특징을 가짐
** TDES연산: DES_key1암호화 – DES_key2복호화 – DES_key3암호화 연산을 수행
- < 블록암호의 보안성 >
- 블록암호: 기밀성 있는 정보를 정해진 블록 단위로 암호화하는 대칭키 암호 시스템
- 블록암호의 보안성: 비밀키 길이가 k비트일 때 2^k개의 비밀키 후보 중에서 암호화에 사용된 키를 찾는 것에 의존
- 컴퓨팅 파워가 증가하면서 DES의 보안강도가 약해졌으나, 다른 암호알고리즘이 제시되기 전까지 TDES를 임시로 사용
※ 2000년 10월 이후, 128bit 이상의 블록크기를 갖는 블록암호알고리즘 (AES, ARIA, SEED 등)이 등장
- (종류) 세 번의 DES 연산에서 서로 다른 세 개의 암호키를 사용하는 ‘3키 TDES’와 암호키 준비(키 스케줄링) 시간을 줄이기 위해 두 개의 암호키만 사용하는 ‘2키 TDES’가 있음
- 2키 TDES는 2015년 이후로 암호화 용도로 사용 중지
- 3키 TDES는 2030년까지 사용 가능한 것으로 권고해왔음
- (사용처) Windows XP 등 이전 운영체제 및 이전 프로토콜 (SSL, 초기 TLS 등)에서 전송 및 저장 중 계정 데이터를 보호하기 위한 방법으로 결제환경에서 자주 사용되었으며,
- 미완성: ... [다음 페이지에 계속]\n\n## Page 3\n\n```markdown
# 금융보안원
## (나) TDES의 보안 취약점
- TDES는 DES의 암호연산 구조상 특징으로 인해 특정 환경에서 비밀키와 상관없이 평문을 알아낼 수 있는 공격에 취약
- TDES는 현재 국내·외에서 권고하는 다른 블록암호*에 비해 작은 블록크기(64bit)를 가짐
* AES, ARIA, SEED 등의 128bit이상 블록크기를 갖는 암호알고리즘
- 특정 운영모드에서 서로 다른 입력 값임에도 암호화된 결과 값이 동일한 '충돌2)'이 일어날 확률이 큼
< 운영모드의 보안성 >
- 운영모드: 블록암호 사용 시 암호화하려는 정보가 블록 길이보다 긴 경우, 블록암호를 처리하는 형태
- 운영모드의 보안성: 사용된 블록암호의 블록 크기에 영향을 받음
- 충돌이 일어날 경우, 충돌된 암호 출력값에서 암호키 없이 입력값을 추측할 수 있음3)
- 특히, 다음의 환경에서 TDES가 활용 될 때 보안성에 큰 영향을 줌
①동일한 비밀키가 중복되어 사용되는 환경, ②일부 평문을 공격자가 알고 있는 환경
- TDES가 TLS, IPSec, SSH와 같은 프로토콜에서 사용되는 경우, 프로토콜 보안성에 영향을 미침
2) 일반적으로는 해시값 충돌처럼 입력값 대비 출력값의 수가 더 적을 때 일어나는 현상을 말하며, TDES와 같은 대칭암호에서는 동일한 암호키와 동일 암호알고리즘에서 서로 다른 입력값에 의한 암호 출력값이 동일한 경우, 충돌이라고 함
3) CVE-2016-2183, Sweet32 취약점은 TLS 64bit 생일공격으로서 블록암호 SSL/TLS 중 특정 설정에서 충돌을 일으켜서 암호화 데이터 중 평문을 추측해 내는 취약점
```\n\n## Page 4\n\n
| 문서 번호<sup>4)</sup> | 문서제목 | 개정정보 | 특이사항 |
|---------------------|----------|----------|----------|
| SP800-57            | 암호키 관리 및 보안강도 (Recommendation for Key Management) | Rev.3(2012.7) → Rev.4(2016.1) | 3키 TDES를 2030년까지 사용가능으로 표기 |
| SP800-67            | TDES 블록암호 (Recommendation for the TDEA Block Cipher) | Rev.1(2004.5) → Rev.2(2017.11) | 3키 TDES에 대해 2<sup>20</sup>개로 블록 수 제한 |
| SP800-131A          | 키 길이와 암호알고리즘 사용 (Transitioning the Use of Cryptographic Algorithms and Key Lengths) | Rev.1(2015.11) → Rev.2(2018.7) | TDES의 사용 중단을 위한 방안 및 일정 포함 |
### 본문
- (SP800-57) 2016년 1월, 개정본(Rev.4)에 3키 TDES를 2030년 까지 사용가능하도록 권고함
- NIST의 기 개정된 표준문서(SP800-67, SP800-131A)와 보안권고 수준을 맞추기 위해 곧 개정 될 것으로 예상
- (SP800-67) 2017년 11월, TDES가 심각한 보안 취약점을 갖고 있기 때문에 하나의 키 묶음으로 암호화 할 수 있는 최대 블록 수를 제한하겠다는 계획 발표 및 문서 개정<sup>5)</sup>
- TLS, IPsec 및 기타 프로토콜에 대한 알고리즘 금지 계획 발표
- TDES 사용자는 AES암호알고리즘으로 대체할 것을 권고
- AES와 동일한 보안강도의 국산 블록암호알고리즘은 SEED, ARIA, LEA가 있음
### 각주
- 4) SP(Special Publications) 특별간행물로써 800 시리즈는 컴퓨터 보안과 관련된 가이드라인, 권장사항, 기술 사양 등을 다룸
- 5) 'TDES의 현재 사용과 삭제에 대한 업데이트(Update to Current Use and Deprecation of TDEA)'\n\n## Page 5\n\n
| 알고리즘 종류 | Rev.1(2015.11) | Rev.2(2018.7) |
|---------------|----------------|----------------|
| 2키 TDES 암호 | 2015년 이후 금지 | 허용 안함      |
| 2키 TDES 복호 | 레거시 사용*   | 레거시 사용     |
| 3키 TDES 암호 | 사용가능       | 2023년까지 지원 중단** 2023이후 허용 안함 |
| 3키 TDES 복호 | 사용가능       | 레거시 사용     |
* 레거시 사용: 이미 암호화 된 데이터를 풀기 위해 사용될 수 있지만, 연산 시 위험할 수 있음을 의미
** 지원 중단: 사용할 수 있지만, 사용자는 보안 위험을 인정해야 함을 의미
- 미완성: ... [다음 페이지에 계속]
###
- 인용: > 사용
---
### 📌 이전 페이지 컨텍스트
- 마지막 문장 일부: ...이트(Update to Current Use and Deprecation of TDEA)'
이 페이지가 이전 내용의 연속이라면 [이전 페이지에서 계속] 표시를 추가해주세요.\n\n## Page 6\n\n
### 본문
- 현 국내·외 암호관련 안내서에서 3키 TDES가 2030년까지 사용 가능한 보안강도(112bit)를 갖고 있다고 명시하고 있기 때문에
- TDES 암호알고리즘을 탑재하는 보안 제품 규격이나 안내서를 개정하여 안전한 암호알고리즘의 종류와 사용처, 적절한 사용 시기를 재 안내할 필요가 있음
※ 금융보안원은 「금융부문 암호기술 활용가이드(2014.12)」등 TDES 내용을 다루고 있는 금융보안 가이드 개정 예정
- 한편, 모든 기관의 가이드가 단기에 개정되는 것에 인력 자원 등의 한계가 있으므로
- 금융권 담당자는 글로벌 서비스 적용을 위해 관련 규격에서 TDES의 사용을 허용하는지 확인 후, 규격 업데이트 또는 후속 조치 필요를 검토해야함
- 취약점 평가 등의 각종 보안 점검 시, 동 내용을 반영하여 점검해야함
### 참고자료
- NIST 간행물, NIST SP800-67 Rev.2 Recommendation for the TDEA Block Cipher, 2017.11
- NIST 간행물, SP800-131A Rev.2 Transitioning the Use of Cryptographic Algorithms and Key Lengths, 2018.7
- NIST 뉴스, Update to Current Use and Deprecation of TDEA, 2017.7.11.
- Cryptosense 블로그, The End of Triple DES, 2017.7.21.
- PCI SSC 블로그, Cryptography Expert on Triple DEA, 2017.11.9.
- NIST 간행물, SP800-57 Part1 Rev.4, Recommendation for Key Management, 2016.1
- Redhat, Sweet32 Birthday attacks against TLS ciphers with 64bit block size(CVE-2016-2183), 2017.7.
- 프랑스 국립정보통신기술연구소 관련 블로그, Sweet32: Birthday attacks on 64-bit block ciphers in TLS and Open VPN
- Common Vulnerabilities and Exposures(US-CERT에서 후원), CVE-2016-2183