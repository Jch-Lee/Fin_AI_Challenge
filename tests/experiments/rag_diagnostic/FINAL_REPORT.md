# RAG 시스템 진단 실험 최종 보고서

## Executive Summary

### 핵심 발견사항
1. **현재 설정 (BM25=70%, Vector=30%)은 대체로 적절**함
2. 60%의 문제가 균형잡힌 패턴을 보임 - 두 검색 방식이 상호보완적
3. Vector 비중을 35-40%로 약간 높이면 성능 개선 기대

## 1. 실험 개요

### 실험 목적
1. **벡터DB 자료의 질 점검**: 현재 지식 베이스가 금융보안 문제 해결에 충분한가?
2. **검색 방식 중요도 판단**: BM25(키워드) vs Vector(의미) 중 어느 것이 더 중요한가?

### 실험 환경
- **RAG 버전**: v2.0 (2300자 청킹)
- **지식 베이스**: 8,270개 청크 (50개 PDF 문서)
- **임베딩 모델**: KURE-v1 (1024차원)
- **하이브리드 가중치**: BM25=70%, Vector=30%
- **정규화 방법**: min_max

### 테스트 데이터
- **빠른 테스트**: 5문제 (객관식 3, 주관식 2)
- **전체 테스트**: 20문제 (객관식 10, 주관식 10) - 진행 중

## 2. 주요 결과

### 2.1 점수 우세 패턴 분석

| 패턴 | 개수 | 비율 | 해석 |
|------|------|------|------|
| BM25 우세 | 1/5 | 20% | 키워드 매칭이 효과적 |
| Vector 우세 | 1/5 | 20% | 의미적 유사성이 중요 |
| 균형 | 3/5 | 60% | 두 방법이 상호보완적 |

### 2.2 문제 유형별 패턴

#### 객관식 문제 (3개)
```
TEST_000: BM25 우세 (3.13) - 금융투자업 구분
TEST_001: 균형 (1.27) - 위험관리 계획
TEST_002: Vector 우세 (0.31) - 관리체계 수립
```

#### 주관식 문제 (2개)
```
TEST_004: 균형 (0.86) - 트로이 목마 RAT
TEST_007: 균형 (0.68) - 전자금융거래법
```

### 2.3 핵심 인사이트

1. **균형잡힌 패턴이 우세 (60%)**
   - BM25와 Vector가 상호보완적으로 작동
   - 하이브리드 검색의 효과성 입증

2. **예상과 다른 주관식 패턴**
   - 예상: 주관식은 Vector 우세
   - 실제: 균형잡힌 패턴
   - 이유: 금융보안 도메인의 전문용어/법령명 특성

3. **현재 설정의 타당성**
   - BM25=70%는 현재 데이터에 적합
   - Vector=30%는 약간 낮을 수 있음

## 3. 개선 권장사항

### 3.1 단기 개선 (1주 이내)

#### 가중치 미세조정 실험
```python
# 테스트 설정
설정_1 = {"bm25": 0.70, "vector": 0.30}  # 현재
설정_2 = {"bm25": 0.65, "vector": 0.35}  # 테스트 1
설정_3 = {"bm25": 0.60, "vector": 0.40}  # 테스트 2
```

#### 기대 효과
- Vector 비중 증가로 의미 검색 강화
- 주관식 문제 성능 향상 기대

### 3.2 중기 개선 (2-3주)

#### 검색 품질 개선
1. **리랭킹 모델 도입**
   - Cross-encoder 기반 재순위 지정
   - 최종 정확도 5-10% 향상 기대

2. **청킹 전략 최적화**
   ```yaml
   현재: chunk_size: 2300, overlap: 200
   테스트: chunk_size: 1800, overlap: 300
   ```

3. **문제 유형별 적응형 가중치**
   ```python
   if is_multiple_choice(question):
       weights = {"bm25": 0.75, "vector": 0.25}
   else:  # descriptive
       weights = {"bm25": 0.60, "vector": 0.40}
   ```

### 3.3 장기 개선 (1개월+)

#### 지식 베이스 확장
- 현재: 8,270개 청크 (50개 PDF)
- 목표: 15,000+ 청크 (100+ PDF)
- 추가 문서: 금융감독원, 한국은행 자료

#### 도메인 특화 임베딩
- 금융보안 도메인 파인튜닝
- 한국어 금융 용어 학습 강화

## 4. 실험의 한계와 향후 계획

### 한계점
1. **샘플 크기**: 5문제로는 통계적 신뢰성 부족
2. **LLM 생성 시간**: 전체 테스트 시 100분+ 소요
3. **단일 설정 테스트**: 다양한 가중치 비교 필요

### 향후 계획
1. **전체 20문제 테스트 완료**
2. **A/B 테스트 실행** (3가지 설정)
3. **정량적 성능 지표 측정**
   - 정확도, 재현율, F1 점수
4. **최종 설정 결정 및 배포**

## 5. 결론

RAG 시스템 진단 실험 결과, 현재의 BM25=70%, Vector=30% 설정은 **기본적으로 적절**하나, **Vector 비중을 35-40%로 약간 높이면** 더 나은 성능을 기대할 수 있습니다.

특히 금융보안 도메인의 특성상 키워드 검색(BM25)이 여전히 중요하지만, 의미적 유사성(Vector)도 무시할 수 없는 역할을 하고 있음을 확인했습니다.

---

**작성일**: 2025-08-20
**작성자**: RAG 진단 팀
**버전**: 1.0